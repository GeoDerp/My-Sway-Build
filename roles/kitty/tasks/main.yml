---
- name: Install kitty terminal (Fedora)
  dnf:
    name: kitty
    state: present
  when: ansible_facts['distribution'] == 'Fedora'
  become: yes

- name: Install kitty terminal (Ubuntu/Debian)
  apt:
    name: kitty
    state: present
  when: ansible_facts['distribution'] in ['Debian', 'Ubuntu']
  become: yes

- name: Install kitty terminal (Arch)
  pacman:
    name: kitty
    state: present
  when: ansible_facts['distribution'] == 'Archlinux'
  become: yes

- name: Ensure kitty config directory exists
  file:
    path: "{{ kitty_config_dir }}"
    state: directory
    mode: '0755'
  become: no

- name: Copy kitty configuration
  copy:
    src: "{{ playbook_dir }}/Backup-.configs/kitty/kitty.conf"
    dest: "{{ kitty_config_dir }}/kitty.conf"
    mode: '0644'
  become: no

- name: Register kitty.conf as wpgtk template
  shell: wpg -ta "{{ kitty_config_dir }}/kitty.conf"
  become: no
  failed_when: false
  register: wpgtk_kitty_result

- name: Report wpgtk registration status for Kitty
  debug:
    msg: "Kitty config {{ 'registered with wpgtk' if wpgtk_kitty_result.rc == 0 else 'not registered - wpgtk may not be installed or configured' }}"
